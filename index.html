<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Form + Live Results</title>
    <style>
      :root{
        /* Tweak these if you want different sizes */
        --form-initial-min: 640px;   /* form height while filling */
        --form-initial-max: 1100px;
        --form-after-submit: 320px;  /* form height after submit */
        --chart-aspect: 16 / 10;     /* width / height ratio for chart */
      }

      html, body { margin:0; padding:0; background:#fff; font-family: Arial, sans-serif; }
      /* Let content use full width so the chart can grow; keep a little padding */
      .container { width: 100%; margin: 0 auto; padding: 16px; box-sizing: border-box; }
      .block { margin-bottom: 24px; }

      /* Make iframes fluid and block-level */
      iframe { width: 100%; border: 0; display: block; }

      /* Form height: flexible while filling */
      #formFrame {
        height: clamp(var(--form-initial-min), 90vh, var(--form-initial-max));
        transition: height 240ms ease;
      }

      /* Chart: responsive using aspect-ratio so the iframe always fills its box */
      .chart-wrap {
        width: 100%;
        aspect-ratio: var(--chart-aspect);
        position: relative; /* fallback anchor */
      }
      .chart-wrap iframe {
        width: 100%;
        height: 100%;
        position: relative;
      }

      /* Tiny screens */
      @media (max-width: 480px) {
        .container { padding: 12px; }
      }

      /* Optional: a simple “jump to results” link */
      .actions { margin: 0 0 12px 0; }
      .actions a {
        text-decoration: none;
        display: inline-block;
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #ddd;
      }
    </style>
  </head>
  <body>
    <div class="container">

      <!-- Optional quick jump link -->
      <div class="actions">
        <a href="#results">Skip to live results ↓</a>
      </div>

      <!-- Google Form (responsive) -->
      <div class="block">
        <iframe
          id="formFrame"
          title="Quick pulse: actions taken (Form)"
          src="https://docs.google.com/forms/d/e/1FAIpQLSePnkxnhsjCdUVEYkUXFRT-IK0H5nDqQHjbOrNqdVxB67K9UQ/viewform?embedded=true">
        </iframe>
      </div>

      <!-- Google Chart (responsive) -->
      <div class="block" id="results">
        <div class="chart-wrap">
          <iframe
            id="chartFrame"
            title="Live results chart"
            scrolling="no"
            src="https://docs.google.com/spreadsheets/d/e/2PACX-1vS1-u7X5Qm212u-m4uNqtbM4djbjHepF5vJMp2jAh_Yst-7tfvAVGjSwHNkElHNQPKdE52sfXL2y2ZH/pubchart?oid=543343219&amp;format=interactive">
          </iframe>
        </div>
      </div>
    </div>

    <script>
      // 1) Shrink the form after submission and jump to results.
      (function () {
        var form = document.getElementById('formFrame');
        var loadCount = 0;
        if (!form) return;

        form.addEventListener('load', function () {
          loadCount += 1;
          // On the second load, assume the user has submitted.
          if (loadCount > 1) {
            form.style.height = 'var(--form-after-submit)';
            var results = document.getElementById('results');
            if (results && results.scrollIntoView) {
              results.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          }
        }, { passive: true });
      })();

      // 2) Nudge the chart to re-render on resize so it fits the new width.
      (function () {
        var chart = document.getElementById('chartFrame');
        if (!chart) return;

        var debounce;
        function refreshChart() {
          // Reassigning src forces a lightweight reload inside the iframe
          // so Google recalculates to the current iframe width/height.
          var src = chart.src;
          chart.src = src;
        }

        // Refresh once after initial load (helps on mobile orientation changes too)
        window.addEventListener('load', function () {
          setTimeout(refreshChart, 100);
        });

        window.addEventListener('resize', function () {
          clearTimeout(debounce);
          debounce = setTimeout(refreshChart, 250);
        });

        window.addEventListener('orientationchange', function () {
          setTimeout(refreshChart, 250);
        });
      })();
    </script>
  </body>
</html>
